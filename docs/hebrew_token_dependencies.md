# תלויות קריטיות, אילוצים מוסריים, ומנגנוני גיבוי

## מבוא

מסמך זה מפרט את:
- **תלויות קריטיות** (Critical Dependencies) - מי תלוי במי, ומה קורה בכשל
- **אילוצים מוסריים** (Ethical Constraints) - הגבלות שאי אפשר לעקוף
- **מנגנוני גיבוי** (Backup Mechanisms) - תוכניות חירום
- **מנגנוני תזמון** (Timing & Causality) - סדר פעולות וזרימת זמן
- **פרוטוקולי התאוששות** (Recovery Protocols) - מה עושים כשמשהו נכשל

---

## חלק א': תלויות קריטיות (Critical Dependencies)

### הגדרה
**תלות קריטית** = טוקן A לא יכול לפעול **כלל** ללא טוקן B.

### טבלת תלויות קריטיות

| טוקן תלוי | תלוי ב- | רמת קריטיות | השפעת כשל | פרוטוקול התאוששות |
|-----------|---------|--------------|-----------|-------------------|
| **T12** (Learn) | **T04** (Storage) | גבוה | אין למידה ללא זיכרון | גיבוי Storage מיידי |
| **T07** (Automation) | **T03** (Compute) | בינוני | אין אוטומציה ללא חישוב | הפעלת Compute רזרבי |
| **T08** (Govern) | **T05** (Identity) | גבוה | אין ממשל ללא זהות | השעיית Govern עד תיקון |
| **T06** (Security) | **T01** (Data) | גבוה | אין הגנה ללא נתונים להגן עליהם | שחזור Data מגיבוי |
| **T10** (Measure) | **T11** (Monitor) | בינוני | מדידה ללא ניטור חלקית | הפעלת Monitor בסיסי |
| **T09** (Standardize) | **T08** (Govern) | בינוני | אין תקינה ללא ממשל | שמירת Standardize קיים |
| **T03** (Compute) | **T02** (Network) | נמוך | חישוב מבודד אפשרי | מעבר למצב מקומי |
| **T04** (Storage) | **T02** (Network) | נמוך | אחסון מקומי אפשרי | מעבר למצב מקומי |
| **T11** (Monitor) | **T05** (Identity) | גבוה | אין ניטור אחראי ללא זהות | השעיית Monitor |
| **T15** (Seriousness) | **כולם** | עליון | מערכת ללא בקרה עליונה | **מצב חירום מוחלט** |

---

### פירוט תלויות קריטיות מרכזיות

#### 1. T12 (Learn) ← T04 (Storage)
**"ללא זיכרון אין למידה"**

**תלות:**
- T12 צורך נתונים היסטוריים מ-T04
- T12 לא יכול להשוות דפוסים ללא היסטוריה
- T12 לא יכול ללמוד מטעויות אם הן לא נשמרו

**תרחיש כשל:**
```
T04 (Storage) נכשל
  → T12 (Learn) עובר למצב "Read-Only"
  → T12 יכול להשתמש בידע קיים
  → T12 לא יכול לעדכן מודלים
  → התראה ל-T08 (Govern): "למידה מושהת"
```

**פרוטוקול התאוששות:**
1. גיבוי מיידי של T04 מאתר משני
2. אם גיבוי נכשל → T15 מופעל (מצב Seriousness)
3. T12 מקבל הרשאה להמשיך עם ידע קפוא
4. כל החלטה מסומנת "ללא למידה חדשה"

---

#### 2. T07 (Automation) ← T03 (Compute)
**"אין אוטומציה ללא כוח חישוב"**

**תלות:**
- T07 זקוק למשאבי CPU/GPU/TPU
- T07 לא יכול לבצע החלטות מורכבות ללא T03

**תרחיש כשל:**
```
T03 (Compute) עומס יתר / קריסה
  → T07 (Automation) מאט
  → אם T03 מתחת לסף → T07 עובר ל-"Manual Mode"
  → החלטות עוברות למאשר אנושי
  → T11 (Monitor) מתריע
```

**פרוטוקול התאוששות:**
1. הפעלת compute רזרבי (cloud backup)
2. הקטנת עומס: השהיית T07 בעדיפות נמוכה
3. עדיפות ל-T06 (Security) ו-T11 (Monitor)
4. אם לא מספיק → T15 מופעל

**רמת קריטיות: בינוני** (ניתן לעבוד במצב ידני)

---

#### 3. T08 (Govern) ← T05 (Identity)
**"אין ממשל ללא זהות"**

**תלות:**
- כל החלטת ממשל חייבת לדעת "מי" החליט
- T08 לא יכול לתעד החלטות ללא T05
- אחריות נמדדת לפי זהות

**תרחיש כשל:**
```
T05 (Identity) נכשל / לא זמין
  → T08 (Govern) **מושהה לחלוטין**
  → אין החלטות חדשות
  → מדיניות קיימת ממשיכה לפעול
  → T15 (Seriousness) מופעל אוטומטית
```

**פרוטוקול התאוששות:**
1. **אין עקיפה** - זו תלות מוחלטת
2. שחזור מיידי של T05 מגיבוי
3. אם T05 לא חוזר → מצב HOLD
4. רק אדם עם אימות פיזי (מחוץ למערכת) יכול להתערב

**רמת קריטיות: גבוה** (אי אפשר לעקוף)

---

#### 4. T15 (Seriousness) ← כל הטוקנים
**"מצב בקרה עליון תלוי במערכת שלמה"**

**תלות:**
- T15 זקוק ל-T11 (Monitor) כדי לזהות מתי להופעל
- T15 זקוק ל-T10 (Measure) כדי להעריך חומרה
- T15 זקוק ל-T06 (Security) כדי לאכוף

**תרחיש כשל:**
```
אם T15 עצמו נכשל → זו קריסת מערכת
  → **מצב חירום מוחלט (TOTAL HOLD)**
  → כל הפעולות נעצרות
  → רק התערבות אנושית ישירה
  → רק "killswitch" פיזי יכול לשחזר
```

**פרוטוקול התאוששות:**
1. אין התאוששות אוטומטית
2. נדרש אדם בעל הרשאה מקסימלית
3. ביקורת מלאה של כל המערכת
4. אתחול מחדש מ-"safe mode"

---

## חלק ב': אילוצים מוסריים (Ethical Constraints)

### הגדרה
**אילוץ מוסרי** = כלל שאי אפשר לעקוף, גם במצב חירום.

### טבלת אילוצים מוסריים

| טוקן מוגבל | מוגבל על ידי | כלל אתי | עונש על הפרה | מנגנון אכיפה |
|-----------|-------------|---------|--------------|--------------|
| **T07** (Automation) | T15, T10, T11 | אין אוטומציה ללא ניטור | השעיית אוטומציה | T15 (Seriousness) |
| **T03** (Compute) | T15, T06 | אין חישוב ללא אבטחה | הגבלת חישוב | T06 (Security) |
| **T08** (Govern) | T13, T15 | אין ממשל ללא זכויות | השעיית ממשל | T15 (Seriousness) |
| **T09** (Standardize) | T10, T13 | אין תקן לא הוגן | ביטול תקן | T10 (Measure) |
| **T02** (Network) | T05, T06 | אין רשת אנונימית | הגבלת רשת | T05+T06 |
| **T04** (Storage) | T05, T13 | אין אחסון של הפרות | מחיקת נתונים | T13+T05 |
| **T11** (Monitor) | T05, T06 | אין ניטור ללא הגנה | השעיית ניטור | T06 (Security) |
| **T12** (Learn) | T04, T10 | אין למידה ללא מדידה | השעיית למידה | T10 (Measure) |
| **T14** (Commons) | T13, T15 | אין Commons מפלה | סגירת משאב | T15 (Seriousness) |

---

### פירוט אילוצים קריטיים

#### אילוץ 1: "אין אוטומציה ללא ניטור"
**T07 ← T15, T10, T11**

**הכלל:**
כל פעולה אוטומטית **חייבת** להיות מנוטרת בזמן אמת.

**הגיון:**
- אוטומציה יכולה לבצע פעולות במהירות עצומה
- ללא ניטור, שגיאה יכולה להתרבות מיליוני פעמים לפני שמבחינים
- בלי ניטור אין למידה (T12)

**אכיפה:**
```python
def execute_automation(action):
    if not T11.is_monitoring(action):
        raise EthicalConstraintError("אין אוטומציה ללא ניטור")

    if T15.is_active():
        # במצב Seriousness - בדיקה מחמירה
        if not T10.measures_are_acceptable(action):
            T15.halt_automation(action)
            return "BLOCKED"

    return T07.execute(action)
```

**עונש על הפרה:**
- נסיון ראשון: אזהרה + תיעוד
- נסיון שני: השהיית T07 לשעה
- נסיון שלישי: הפעלת T15 + חקירה

---

#### אילוץ 2: "אין חישוב ללא אבטחה"
**T03 ← T15, T06**

**הכלל:**
כל משאב חישוב חייב להיות מאובטח (encrypted, authenticated, monitored).

**הגיון:**
- חישוב על נתונים רגישים ללא הצפנה = פרצת אבטחה
- חישוב אנונימי = אי אפשר לעקוב אחר שימוש לרעה

**אכיפה:**
```python
def allocate_compute(task):
    if not T06.is_secured(task):
        raise EthicalConstraintError("אין חישוב ללא אבטחה")

    if task.uses_personal_data():
        if not T06.is_encrypted(task.data):
            return "BLOCKED"

    return T03.allocate(task)
```

**מקרה מיוחד - Seriousness:**
אם T15 פעיל, T03 מוגבל ל"חישוב הכרחי בלבד":
- T06 (Security) ✓
- T11 (Monitor) ✓
- T12 (Learn) ✓
- חישובי אופטימיזציה? ✗ (מושהה)

---

#### אילוץ 3: "אין ממשל ללא זכויות"
**T08 ← T13, T15**

**הכלל:**
כל החלטת ממשל חייבת לעבור בדיקה מול T13 (Rights).

**הגיון:**
- ממשל יעיל שפוגע בזכויות = רודנות
- יעילות לא יכולה לגבור על חירות

**אכיפה:**
```python
def govern_decision(policy):
    if T13.violates_rights(policy):
        T15.activate("הפרת זכויות על ידי ממשל")
        T08.suspend()
        return "BLOCKED - הפרת זכויות"

    return T08.implement(policy)
```

**דוגמה:**
- ✗ מדיניות: "נאסוף נתונים ללא הסכמה כדי לשפר שירות"
- ✓ מדיניות: "נבקש הסכמה, ונשפר רק עם מי שהסכים"

---

#### אילוץ 4: "אין תקן לא הוגן"
**T09 ← T10, T13**

**הכלל:**
תקנים (standards) חייבים להיבדק מול הוגנות ומדידה.

**הגיון:**
- אם T09 (Standardize) מוטה → T10 (Measure) יצור תוצאות מוטות
- תקן לא הוגן = אפליה מובנית

**אכיפה:**
```python
def implement_standard(standard):
    bias_score = T10.measure_bias(standard)

    if bias_score > BIAS_THRESHOLD:
        T15.activate("תקן מוטה")
        T09.reject(standard)
        return "REJECTED - תקן לא הוגן"

    return T09.implement(standard)
```

**תהליך בדיקה:**
1. T09 מציע תקן
2. T10 בודק הטיה
3. T11 מנטר את השפעתו בפועל (לאחר יישום)
4. T12 לומד אם יש השפעות לא צפויות
5. אם T10/T11 מזהים בעיה → T15 מופעל → T09 מתוקן

---

#### אילוץ 5: "אין רשת אנונימית"
**T02 ← T05, T06**

**הכלל:**
כל תקשורת רשת חייבת Identity + Security.

**הגיון:**
- רשת אנונימית = אי אפשר לעקוב אחר שימוש לרעה
- אי אפשר לאכוף T13 (Rights) ללא T05 (Identity)

**אכיפה:**
```python
def network_request(request):
    if not T05.has_identity(request):
        return "BLOCKED - חסר זיהוי"

    if not T06.is_encrypted(request):
        return "BLOCKED - חסר הצפנה"

    return T02.transmit(request)
```

**יוצאי דופן המותרים:**
- תקשורת מוצפנת מקצה לקצה עם זהות מאומתת
- ✓ דוגמה: Signal Protocol (זהות + הצפנה)
- ✗ דוגמה: רשת Tor מלאה (אנונימיות מלאה)

---

## חלק ג': מנגנוני גיבוי (Backup & Redundancy)

### עקרון הגיבוי
> "כל רכיב קריטי חייב גיבוי. אבל גיבוי לא יכול לעקוף אילוץ מוסרי."

### טבלת גיבויים

| טוקן ראשי | גיבוי | רמת חלופיות | תנאי מעבר | אובדן ביצועים |
|-----------|-------|-------------|-----------|----------------|
| **T03** (Compute) | T04 (חישוב מתוך cache) | חלקית | כשל Compute | 40% |
| **T04** (Storage) | T03 (זיכרון זמני) | חלקית | כשל Storage | 60% |
| **T06** (Security) | T15 (מצב חירום) | מוחלטת | כשל Security | 10% (חירום) |
| **T10** (Measure) | T11 (ספירה בסיסית) | חלקית | כשל Measure | 30% |
| **T11** (Monitor) | T10 (דגימה) | חלקית | כשל Monitor | 30% |
| **T12** (Learn) | T04 (ידע קפוא) | חלקית | כשל Learn | 50% |
| **T08** (Govern) | T09 (כללים קיימים) | חלקית | כשל Govern | 50% |
| **T09** (Standardize) | T08 (מדיניות) | חלקית | כשל Standardize | 50% |

### טוקנים ללא גיבוי (Critical Without Backup)

| טוקן | סיבה |
|------|------|
| **T02** (Network) | אין חלופה לרשת - כשל = מצב מקומי בלבד |
| **T05** (Identity) | אין חלופה לזיהוי - כשל = קריסה |
| **T13** (Rights) | אין חלופה לזכויות - אלו ערכי יסוד |
| **T01** (Data) | אין חלופה לנתונים - כשל = קריטי |
| **T15** (Seriousness) | אין חלופה לבקרה עליונה - כשל = חירום מוחלט |

---

### מנגנון גיבוי לדוגמה: T03 ↔ T04

**רעיון:**
- T03 (Compute) ו-T04 (Storage) יכולים לגבות זה את זה **חלקית**
- אם T03 נכשל → T04 יכול להשתמש בתוצאות cache
- אם T04 נכשל → T03 יכול להשתמש בזיכרון זמני

**מימוש:**
```python
class ComputeWithBackup:
    def compute(self, task):
        try:
            return T03.execute(task)
        except T03Failure:
            # נסיון גיבוי: חיפוש ב-cache
            cached = T04.get_cached_result(task)
            if cached and not too_old(cached):
                return cached
            else:
                raise CriticalFailure("גם T03 וגם גיבוי נכשלו")
```

**מגבלות:**
- cache עובד רק לתוצאות שכבר חושבו
- לא מתאים למשימות חדשות
- אובדן ביצועים: 40%

---

## חלק ד': תזמון וסיבתיות (Timing & Causality)

### שרשראות סיבתיות (Causal Chains)

#### שרשרת 1: אירוע → נתונים → מדידה
```
אירוע מתרחש (t=0)
  → T01 (Data) קולט (t=0, דיליי 0)
  → T06 (Security) בודק (t=1, דיליי 1 שלב)
  → T04 (Storage) שומר (t=1)
  → T11 (Monitor) צופה (t=1)
  → T10 (Measure) מודד (t=2, דיליי 2 שלבים)
```

**זמן כולל:** 2 שלבים (steps)

#### שרשרת 2: מדידה → למידה → ממשל → אוטומציה
```
T10 (Measure) מזהה דפוס (t=0)
  → T11 (Monitor) מנתח (t=1, דיליי 1)
  → T12 (Learn) מפיק תובנה (t=3, דיליי 3 שלבים)
  → T08 (Govern) מעדכן מדיניות (t=5, דיליי 2)
  → T09 (Standardize) מיישם תקן (t=6, דיליי 1)
  → T07 (Automation) מתעדכן (t=7, דיליי 1)
```

**זמן כולל:** 7 שלבים

#### שרשרת 3: חירום (הפרת זכויות → Seriousness)
```
T13 (Rights) מזהה הפרה (t=0)
  → T15 (Seriousness) מופעל (t=0, מיידי!)
  → T07 (Automation) מושהה (t=0, מיידי!)
  → T03 (Compute) מוגבל (t=0, מיידי!)
  → T06 (Security) מוגבר (t=0, מיידי!)
```

**זמן כולל:** 0 שלבים (מיידי)

---

### טבלת זמני תגובה

| טריגר | טוקן מפעיל | דיליי | טוקן מושפע | שרשרת |
|-------|-----------|-------|-----------|-------|
| אירוע חדש | T01 | 0 | כל דבר | ראשוני |
| השעיית Automation | T15 | 1 | T07 | הגנה |
| ניתוח Monitor | T11 | 1 | T10 | ניטור→מדידה |
| מדידה גבוהה | T10 | 2 | T12 | מדידה→למידה |
| למידה | T12 | 3 | T08 | למידה→ממשל |
| עדכון Govern | T08 | 2 | T09 | ממשל→תקינה |
| קביעת תקן | T09 | 1 | T07 | תקינה→אוטומציה |
| הפרת זכויות | T13 | 0 | T15 | **מיידי** |
| זיהוי סכנה | T11 | 0 | T15 | **מיידי** |

---

## חלק ה': פרוטוקולי התאוששות (Recovery Protocols)

### רמות חומרה

| רמה | שם | תיאור | פרוטוקול |
|-----|-----|-------|----------|
| 0 | תקין | כל הטוקנים פועלים | - |
| 1 | אזהרה | טוקן לא קריטי נכשל | התראה + ניטור |
| 2 | שגיאה | טוקן קריטי נכשל | גיבוי + תיקון |
| 3 | חירום | מספר טוקנים נכשלו | T15 מופעל |
| 4 | קריסה | T15/T05/T13 נכשל | HOLD מוחלט |

---

### פרוטוקול התאוששות - רמה 1 (אזהרה)

**דוגמה:** T09 (Standardize) איטי

**צעדים:**
1. T11 (Monitor) מזהה: "T09 לוקח זמן רב"
2. T10 (Measure) בודק: האם זה משפיע על משתמשים?
3. אם לא → רק logging
4. אם כן → T12 (Learn) חוקר למה
5. T08 (Govern) מחליט: להמתין או להקצות T03 (Compute) נוסף

---

### פרוטוקול התאוששות - רמה 2 (שגיאה)

**דוגמה:** T04 (Storage) קריסה חלקית

**צעדים:**
1. **זיהוי מיידי** (T11)
2. **הפעלת גיבוי:**
   - T04 עובר לדיסק משני
   - T12 (Learn) עובר ל-"ידע קפוא"
3. **הודעה למשתמשים:** "שירות מוגבל"
4. **T08 (Govern) מחליט:**
   - עדיפות לתיקון T04
   - הגבלת T07 (Automation) שצורך Storage
5. **תיקון:**
   - טכנאי / סקריפט אוטומטי
   - בדיקה שהתיקון עובד
6. **שחזור מלא:**
   - T04 חוזר למצב מלא
   - T12 מתעדכן
   - T15 מאשר: "מצב תקין"

---

### פרוטוקול התאוששות - רמה 3 (חירום)

**דוגמה:** T05 (Identity) + T03 (Compute) נכשלו ביחד

**צעדים:**
1. **הפעלה אוטומטית של T15**
2. **T15 מעריך:**
   - איזה טוקנים עדיין חיים?
   - T06 (Security): ✓
   - T11 (Monitor): ✓
   - T08 (Govern): ✗ (תלוי ב-T05)
   - T03 (Compute): ✗
3. **החלטת T15:**
   - השעיית T07, T08, T12 (תלויים ב-T03/T05)
   - מצב "Minimal Operation"
   - רק T06, T11, T04 פעילים
4. **קריאה לאדם:**
   - התראה לצוות
   - "דרוש אימות פיזי"
5. **אדם מאשר זהות ידנית**
6. **שחזור הדרגתי:**
   - T05 → T03 → T08 → שאר

---

### פרוטוקול התאוששות - רמה 4 (קריסה מוחלטת)

**תרחיש:** T15 עצמו נכשל / T13 נפרץ / T01 נמחק

**זהו מצב אסון.**

**צעדים:**
1. **HOLD אוטומטי:**
   - כל הטוקנים נעצרים
   - מצב "קפוא"
2. **ניתוק רשת (T02):**
   - בידוד מוחלט
   - מניעת נזק נוסף
3. **קריאה חירום:**
   - SMS/דוא"ל לצוות מוגדר
   - "CRITICAL SYSTEM FAILURE"
4. **התערבות פיזית:**
   - אדם בעל הרשאת root
   - גישה פיזית למכונה
   - אימות ביומטרי + סיסמה
5. **בדיקה מלאה:**
   - audit של כל הלוגים
   - האם הייתה פריצה?
   - האם יש קורפציה?
6. **החלטה:**
   - תיקון → אתחול חוזר
   - או: שחזור מגיבוי מלא (rollback)
7. **אם גיבוי לא עובד:**
   - **מצב אובדן מוחלט**
   - שחזור יד מתיעוד חיצוני

---

## סיכום: שלושת עקרונות ההתאוששות

### 1. עקרון הבטיחות (Safety First)
> "במצב ספק - עצור. עדיף מערכת עצורה ממערכת לא מהימנה."

### 2. עקרון האדם (Human in the Loop)
> "כשל קריטי דורש אדם. אין התאוששות אוטומטית ברמה 3+."

### 3. עקרון התיעוד (Documentation)
> "כל כשל, כל התאוששות, מתועדים ב-T04. אחרת T12 לא ילמד."

---

**המערכת בנויה כך שהיא יכולה להתאושש מכמעט כל דבר - אבל לא במחיר הפרת האילוצים המוסריים.**
